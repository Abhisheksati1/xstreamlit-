import { createContext, useState } from "react"
import { Event, hydrateClientStorage, useEventLoop } from "/utils/state.js"

export const initialState = {"animate": {"opacity": 1, "scale": 1}, "color": "#db114b", "data": {"columns": ["col 0", "col 1", "col 2", "col 3", "col 4", "col 5", "col 6", "col 7", "col 8", "col 9"], "data": [[0.4902402792890893, 0.3306219584758054, -1.5440278375690286, 0.13906667031696485, -0.6657385802527712, 0.9661765880877903, 0.31012694345531955, 2.217239686688384, -0.04767214000716102, 0.08104479151487319], [1.3883095364583335, -0.16741816245628235, 0.13335692581651443, 0.13635634218803636, 0.42958773426433927, 1.4196290504385678, 0.7944177361778131, 0.5580968556414241, 0.30364776823785683, -1.1091135719131406], [0.2049124974199119, 0.16033936693331036, -0.7821965787393629, -0.04624909103449062, -1.887695714712818, -1.6131174863180482, 0.5770678203128886, -1.6015648818214259, 0.573017117518223, -0.22714255492273455], [-0.6380610409166934, 0.16647576983991041, 0.6012034414522146, -0.4006423505935688, 0.8870792017718451, 0.22694035369638874, 1.2178310048975476, 0.11386686094031237, -1.1416408350760683, 0.03329874207307461], [0.35442540861306077, -2.340982582946801, 0.8114620437787506, 1.1622131689038566, -1.2336098298382057, -0.5554063899126988, 0.5834913021286147, 0.7336568420383888, 0.5107760191610343, -1.4233712157445229], [0.15556565622836993, -0.49209466209160685, -0.5093844113469073, -0.4454319419906647, 0.23772327287020026, -0.142616157333091, -1.8569716492407788, 0.7284191397716648, -0.5560587686703672, -0.03009011292361652], [-1.136089036596219, 1.7194749720265596, 0.5507410710400265, 0.9555340839707533, -0.04985017502597914, -0.13070409240067374, 0.2624351546937555, -0.47896205053337293, 0.2907601122397032, -1.097870600790479], [-1.7259226227442954, -0.595773328912959, -1.048013290752095, 0.02973033634493102, 0.4588469545382178, 0.3661597776776349, -1.3026966830430418, -1.433682308297981, -0.004236711506122193, 0.19400297696402294], [1.7301636311964932, 0.8009316365677884, -1.6899450830979557, 2.4447566990077996, 1.9657507790250859, -1.2180489039014286, 0.8723572457297066, 0.38409255388090635, -0.32448586931336765, 1.365472962217398], [-0.05820613057413245, 2.115961466644588, 0.19363725373602583, -1.3146115895182657, 0.2475744772510513, -0.31268223722816624, -1.0206552784497218, -0.6269143292025763, -0.880587532205262, 1.2486500042340956]]}, "data_list": [{"x": 1, "y": 1}, {"x": 2, "y": 4}, {"x": 3, "y": 9}, {"x": 4, "y": 16}, {"x": 5, "y": 10}], "eq": " a + ar + a r^2 + a r^3 + \\cdots + a r^{n-1} =\n    \\sum_{k=0}^{n-1} ar^k =\n    a \\left(\\frac{1-r^{n}}{1-r}\\right)", "initial": {"opacity": 0, "scale": 0.5}, "is_hydrated": false, "router": {"session": {"client_token": "", "client_ip": "", "session_id": ""}, "headers": {"host": "", "origin": "", "upgrade": "", "connection": "", "pragma": "", "cache_control": "", "user_agent": "", "sec_websocket_version": "", "sec_websocket_key": "", "sec_websocket_extensions": "", "accept_encoding": "", "accept_language": ""}, "page": {"host": "", "path": "", "raw_path": "", "full_path": "", "full_raw_path": "", "params": {}}}, "transition": {"duration": 0.5}}

export const ColorModeContext = createContext(null);
export const StateContext = createContext(null);
export const EventLoopContext = createContext(null);
export const clientStorage = {"cookies": {}, "local_storage": {}}

export const initialEvents = () => [
    Event('state.hydrate', hydrateClientStorage(clientStorage)),
]

export const isDevMode = true

export function EventLoopProvider({ children }) {
  const [state, addEvents, connectError] = useEventLoop(
    initialState,
    initialEvents,
    clientStorage,
  )
  return (
    <EventLoopContext.Provider value={[addEvents, connectError]}>
      <StateContext.Provider value={state}>
        {children}
      </StateContext.Provider>
    </EventLoopContext.Provider>
  )
}